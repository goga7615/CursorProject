# Инструкции по настройке Google Таблиц

## Шаг 1: Создание новой таблицы

1. Откройте [Google Таблицы](https://sheets.google.com)
2. Создайте новую таблицу
3. Переименуйте таблицу в "Система разбора блюд"

## Шаг 2: Создание листов

Создайте следующие листы (щелкните правой кнопкой мыши по вкладке "Лист1" → "Переименовать"):

1. **Ингредиенты** - база всех продуктов
2. **Полуфабрикаты** - промежуточные продукты
3. **Рецепты** - связь полуфабрикатов с ингредиентами
4. **Блюда** - готовые блюда
5. **Состав_блюд** - связь блюд с компонентами
6. **Сводка** - аналитика и отчеты

## Шаг 3: Настройка листа "Ингредиенты"

### Заголовки (строка 1):
```
A1: ID | B1: Название | C1: Категория | D1: Ед.изм. | E1: Стоимость | F1: Калории | G1: Белки | H1: Жиры | I1: Углеводы
```

### Форматирование:
- Выделите строку 1
- Примените жирный шрифт и заливку
- Закрепите строку (Вид → Закрепить → 1 строка)

### Выпадающие списки:

#### Категории (столбец C):
1. Выделите столбец C (кроме заголовка)
2. Данные → Проверка данных
3. Критерий: Список элементов
4. Источник: `Овощи,Фрукты,Мясо,Рыба,Молочные продукты,Крупы,Специи,Масла,Консервы,Хлеб`

#### Единицы измерения (столбец D):
1. Выделите столбец D (кроме заголовка)
2. Данные → Проверка данных
3. Критерий: Список элементов
4. Источник: `г,кг,мл,л,шт,пучок,щепотка`

### Формулы:
- Столбец A (ID): оставьте пустым для ручного ввода
- Столбцы E-I: формат "Число" с 2 знаками после запятой

## Шаг 4: Настройка листа "Полуфабрикаты"

### Заголовки (строка 1):
```
A1: ID | B1: Название | C1: Описание | D1: Выход (г) | E1: Стоимость | F1: Калории
```

### Формулы:

#### Стоимость (столбец E):
```
=SUMIF(Рецепты!B:B,A2,Рецепты!E:E)
```

#### Калории (столбец F):
```
=SUMIF(Рецепты!B:B,A2,Рецепты!F:F)
```

## Шаг 5: Настройка листа "Рецепты"

### Заголовки (строка 1):
```
A1: ID | B1: ID_полуфабриката | C1: ID_ингредиента | D1: Количество | E1: Стоимость | F1: Калории
```

### Формулы:

#### Стоимость (столбец E):
```
=D2*VLOOKUP(C2,Ингредиенты!A:E,5,FALSE)
```

#### Калории (столбец F):
```
=D2*VLOOKUP(C2,Ингредиенты!A:I,6,FALSE)/100
```

## Шаг 6: Настройка листа "Блюда"

### Заголовки (строка 1):
```
A1: ID | B1: Название | C1: Категория | D1: Порция (г) | E1: Стоимость | F1: Калории
```

### Выпадающие списки:

#### Категории блюд (столбец C):
1. Выделите столбец C (кроме заголовка)
2. Данные → Проверка данных
3. Критерий: Список элементов
4. Источник: `Первые блюда,Вторые блюда,Салаты,Десерты,Напитки,Закуски`

### Формулы:

#### Стоимость (столбец E):
```
=SUMIF(Состав_блюд!B:B,A2,Состав_блюд!F:F)
```

#### Калории (столбец F):
```
=SUMIF(Состав_блюд!B:B,A2,Состав_блюд!G:G)
```

## Шаг 7: Настройка листа "Состав_блюд"

### Заголовки (строка 1):
```
A1: ID | B1: ID_блюда | C1: Тип_компонента | D1: ID_компонента | E1: Количество | F1: Стоимость | G1: Калории
```

### Выпадающие списки:

#### Тип компонента (столбец C):
1. Выделите столбец C (кроме заголовка)
2. Данные → Проверка данных
3. Критерий: Список элементов
4. Источник: `Ингредиент,Полуфабрикат`

### Формулы:

#### Стоимость (столбец F):
```
=E2*IF(C2="Ингредиент",VLOOKUP(D2,Ингредиенты!A:E,5,FALSE),VLOOKUP(D2,Полуфабрикаты!A:E,5,FALSE))
```

#### Калории (столбец G):
```
=E2*IF(C2="Ингредиент",VLOOKUP(D2,Ингредиенты!A:I,6,FALSE)/100,VLOOKUP(D2,Полуфабрикаты!A:F,6,FALSE)/100)
```

## Шаг 8: Настройка листа "Сводка"

### Создайте следующие разделы:

#### Общая статистика:
```
A1: Общая статистика
A3: Всего блюд: | B3: =COUNTA(Блюда!A:A)-1
A4: Всего ингредиентов: | B4: =COUNTA(Ингредиенты!A:A)-1
A5: Всего полуфабрикатов: | B5: =COUNTA(Полуфабрикаты!A:A)-1
```

#### Топ-5 самых дорогих блюд:
```
A7: Топ-5 самых дорогих блюд
A8: =QUERY(Блюда!A:F,"SELECT B,E ORDER BY E DESC LIMIT 5")
```

#### Средняя стоимость по категориям:
```
A14: Средняя стоимость по категориям
A15: =QUERY(Блюда!A:F,"SELECT C,AVG(E) GROUP BY C ORDER BY AVG(E) DESC")
```

## Шаг 9: Заполнение данными

### Порядок заполнения:
1. **Ингредиенты** - заполните базу продуктов
2. **Полуфабрикаты** - добавьте промежуточные продукты
3. **Рецепты** - свяжите полуфабрикаты с ингредиентами
4. **Блюда** - добавьте готовые блюда
5. **Состав_блюд** - свяжите блюда с компонентами

### Пример заполнения:

#### Ингредиент "Свекла":
```
A2: 1
B2: Свекла
C2: Овощи
D2: г
E2: 0.15
F2: 43
G2: 1.6
H2: 0.2
I2: 9.6
```

## Шаг 10: Проверка формул

### Тестирование:
1. Добавьте тестовые данные
2. Проверьте, что формулы работают корректно
3. Убедитесь, что ссылки между листами корректны

### Частые ошибки:
- Неправильные ссылки на листы
- Отсутствие кавычек в названиях листов
- Неправильный порядок столбцов в VLOOKUP

## Шаг 11: Дополнительные настройки

### Условное форматирование:
1. Выделите диапазон данных
2. Формат → Условное форматирование
3. Настройте правила (например, выделение дорогих блюд)

### Фильтры:
1. Выделите заголовки
2. Данные → Создать фильтр
3. Используйте для быстрого поиска

### Защита листов:
1. Выделите ячейки с формулами
2. Щелкните правой кнопкой → Защитить диапазон
3. Настройте права доступа

## Шаг 12: Экспорт и совместная работа

### Экспорт:
- Файл → Скачать → Microsoft Excel (.xlsx)
- Файл → Скачать → PDF документ

### Совместная работа:
- Нажмите кнопку "Настроить доступ"
- Добавьте email-адреса участников
- Настройте права доступа

## Полезные советы

1. **Используйте абсолютные ссылки** для формул, которые нужно копировать
2. **Проверяйте данные** перед вводом
3. **Делайте резервные копии** важных данных
4. **Используйте комментарии** для сложных формул
5. **Тестируйте на малых данных** перед масштабированием

## Решение проблем

### Формула не работает:
- Проверьте синтаксис
- Убедитесь, что ссылки корректны
- Проверьте формат данных

### Ошибка #N/A:
- Проверьте, существует ли искомое значение
- Убедитесь, что порядок столбцов правильный

### Ошибка #VALUE:
- Проверьте типы данных
- Убедитесь, что все значения числовые
