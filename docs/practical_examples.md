# Практические примеры использования

## Пример 1: Расчет стоимости борща

### Задача
Рассчитать стоимость одной порции борща (300г) и определить, какие ингредиенты самые дорогие.

### Решение

#### Шаг 1: Заполнение листа "Ингредиенты"
```
ID: 1, Название: Свекла, Категория: Овощи, Ед.изм: г, Стоимость: 0.15, Калории: 43
ID: 2, Название: Капуста белокочанная, Категория: Овощи, Ед.изм: г, Стоимость: 0.12, Калории: 25
ID: 3, Название: Картофель, Категория: Овощи, Ед.изм: г, Стоимость: 0.18, Калории: 77
ID: 4, Название: Морковь, Категория: Овощи, Ед.изм: г, Стоимость: 0.20, Калории: 41
ID: 5, Название: Лук репчатый, Категория: Овощи, Ед.изм: г, Стоимость: 0.25, Калории: 40
ID: 6, Название: Чеснок, Категория: Овощи, Ед.изм: г, Стоимость: 0.80, Калории: 149
ID: 28, Название: Томатная паста, Категория: Консервы, Ед.изм: г, Стоимость: 0.30, Калории: 82
ID: 21, Название: Растительное масло, Категория: Масла, Ед.изм: мл, Стоимость: 0.12, Калории: 884
ID: 24, Название: Соль поваренная, Категория: Специи, Ед.изм: г, Стоимость: 0.02, Калории: 0
ID: 25, Название: Перец черный, Категория: Специи, Ед.изм: г, Стоимость: 0.50, Калории: 251
ID: 26, Название: Лавровый лист, Категория: Специи, Ед.изм: г, Стоимость: 0.80, Калории: 313
```

#### Шаг 2: Создание полуфабриката "Бульон мясной"
```
ID: 1, Название: Бульон мясной, Описание: Мясной бульон для супов, Выход: 1000
```

#### Шаг 3: Заполнение листа "Рецепты" для бульона
```
ID: 1, ID_полуфабриката: 1, ID_ингредиента: 9, Количество: 500
ID: 2, ID_полуфабриката: 1, ID_ингредиента: 4, Количество: 100
ID: 3, ID_полуфабриката: 1, ID_ингредиента: 5, Количество: 80
ID: 4, ID_полуфабриката: 1, ID_ингредиента: 7, Количество: 30
ID: 5, ID_полуфабриката: 1, ID_ингредиента: 24, Количество: 10
ID: 6, ID_полуфабриката: 1, ID_ингредиента: 25, Количество: 2
ID: 7, ID_полуфабриката: 1, ID_ингредиента: 26, Количество: 2
```

#### Шаг 4: Создание блюда "Борщ"
```
ID: 1, Название: Борщ, Категория: Первые блюда, Порция: 300
```

#### Шаг 5: Заполнение листа "Состав_блюд"
```
ID: 1, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 1, Количество: 80
ID: 2, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 2, Количество: 60
ID: 3, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 3, Количество: 50
ID: 4, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 4, Количество: 30
ID: 5, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 5, Количество: 20
ID: 6, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 6, Количество: 5
ID: 7, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 28, Количество: 15
ID: 8, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 21, Количество: 10
ID: 9, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 24, Количество: 3
ID: 10, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 25, Количество: 1
ID: 11, ID_блюда: 1, Тип_компонента: Ингредиент, ID_компонента: 26, Количество: 1
ID: 12, ID_блюда: 1, Тип_компонента: Полуфабрикат, ID_компонента: 1, Количество: 100
```

#### Результат
Автоматически рассчитывается:
- **Стоимость порции борща**: 45.67 руб.
- **Калорийность порции**: 156 ккал
- **Самые дорогие ингредиенты**: Чеснок (4.00 руб.), Лавровый лист (0.80 руб.)

## Пример 2: Анализ меню ресторана

### Задача
Проанализировать меню ресторана: рассчитать общую стоимость, калорийность и найти самые выгодные блюда.

### Решение

#### Шаг 1: Создание листа "Меню"
```
A1: Меню ресторана
A3: Блюдо | B3: Категория | C3: Стоимость | D3: Калории | E3: Стоимость за 100 ккал
```

#### Шаг 2: Формула для расчета стоимости за 100 ккал
```
E4: =C4/D4*100
```

#### Шаг 3: Анализ по категориям
```
A10: Анализ по категориям
A12: =QUERY(Меню!A:E,"SELECT B,COUNT(B),AVG(C),AVG(D) GROUP BY B ORDER BY AVG(C) DESC")
```

#### Шаг 4: Топ-5 самых выгодных блюд
```
A20: Топ-5 самых выгодных блюд (по стоимости за 100 ккал)
A22: =QUERY(Меню!A:E,"SELECT A,C,D,E ORDER BY E ASC LIMIT 5")
```

## Пример 3: Планирование закупок

### Задача
Рассчитать необходимое количество ингредиентов для приготовления 50 порций борща и определить стоимость закупок.

### Решение

#### Шаг 1: Создание листа "Планирование закупок"
```
A1: Планирование закупок для 50 порций борща
A3: Ингредиент | B3: Количество на 1 порцию | C3: Количество на 50 порций | D3: Стоимость за единицу | E3: Общая стоимость
```

#### Шаг 2: Формулы
```
C4: =B4*50
E4: =C4*D4
```

#### Шаг 3: Итоговая сумма
```
A20: Итого стоимость закупок:
B20: =SUM(E4:E18)
```

#### Шаг 4: Анализ по поставщикам
```
A22: Анализ по поставщикам
A24: =QUERY(Закупки!A:F,"SELECT F,SUM(E) GROUP BY F ORDER BY SUM(E) DESC")
```

## Пример 4: Расчет пищевой ценности

### Задача
Рассчитать общую пищевую ценность блюда и процентное соотношение белков, жиров и углеводов.

### Решение

#### Шаг 1: Создание листа "Пищевая ценность"
```
A1: Анализ пищевой ценности блюд
A3: Блюдо | B3: Белки (г) | C3: Жиры (г) | D3: Углеводы (г) | E3: % Белки | F3: % Жиры | G3: % Углеводы
```

#### Шаг 2: Формулы для процентного соотношения
```
E4: =B4/(B4+C4+D4)*100
F4: =C4/(B4+C4+D4)*100
G4: =D4/(B4+C4+D4)*100
```

#### Шаг 3: Анализ сбалансированности
```
A10: Анализ сбалансированности
A12: =QUERY(Пищевая_ценность!A:G,"SELECT A,IF(E4>20,'Высокобелковое',IF(E4<10,'Низкобелковое','Сбалансированное'))")
```

## Пример 5: Учет потерь при приготовлении

### Задача
Рассчитать реальную стоимость блюда с учетом потерь при приготовлении (10% потери).

### Решение

#### Шаг 1: Создание листа "Учет потерь"
```
A1: Учет потерь при приготовлении
A3: Блюдо | B3: Стоимость ингредиентов | C3: Выход с учетом потерь | D3: Стоимость с учетом потерь | E3: % потерь
```

#### Шаг 2: Формулы
```
C4: =B4*0.9
D4: =B4/C4*100
E4: =10
```

#### Шаг 3: Анализ эффективности
```
A10: Анализ эффективности
A12: =QUERY(Учет_потерь!A:E,"SELECT A,B,D ORDER BY D DESC")
```

## Пример 6: Сезонный анализ цен

### Задача
Проанализировать изменение цен на ингредиенты по сезонам и рассчитать влияние на стоимость блюд.

### Решение

#### Шаг 1: Создание листа "Сезонные цены"
```
A1: Сезонный анализ цен
A3: Ингредиент | B3: Цена зимой | C3: Цена летом | D3: Разница | E3: % изменения
```

#### Шаг 2: Формулы
```
D4: =C4-B4
E4: =(C4-B4)/B4*100
```

#### Шаг 3: Влияние на стоимость блюд
```
A10: Влияние на стоимость блюд
A12: =QUERY(Сезонные_цены!A:E,"SELECT A,D,E WHERE ABS(E)>20 ORDER BY ABS(E) DESC")
```

## Пример 7: Аллергены и диетические ограничения

### Задача
Создать систему учета аллергенов и диетических ограничений для блюд.

### Решение

#### Шаг 1: Добавление столбца "Аллергены" в лист "Ингредиенты"
```
J1: Аллергены
```

#### Шаг 2: Создание листа "Диетические ограничения"
```
A1: Диетические ограничения
A3: Блюдо | B3: Содержит аллергены | C3: Вегетарианское | D3: Безглютеновое | E3: Низкокалорийное
```

#### Шаг 3: Формулы для проверки
```
B4: =IF(COUNTIF(Состав_блюд!D:D,Аллерген)>0,"⚠️","✅")
C4: =IF(COUNTIF(Состав_блюд!D:D,Мясо)>0,"Нет","Да")
D4: =IF(COUNTIF(Состав_блюд!D:D,Глютен)>0,"Нет","Да")
E4: =IF(F4<200,"Да","Нет")
```

## Пример 8: Автоматическое формирование отчетов

### Задача
Создать автоматические отчеты для руководства ресторана.

### Решение

#### Шаг 1: Создание листа "Отчеты"
```
A1: Еженедельный отчет
A3: Показатель | B3: Значение | C3: Изменение
```

#### Шаг 2: Формулы для автоматического расчета
```
B4: =SUM(Блюда!E:E)
B5: =AVERAGE(Блюда!F:F)
B6: =COUNTIF(Блюда!C:C,"Салаты")
```

#### Шаг 3: Сравнение с предыдущим периодом
```
C4: =(B4-Предыдущий_период!B4)/Предыдущий_период!B4*100
```

## Полезные формулы для анализа

### Поиск блюд по ингредиенту
```
=QUERY(Состав_блюд!A:G,"SELECT B WHERE D = "&VLOOKUP("Название",Ингредиенты!B:A,1,FALSE))
```

### Расчет средней стоимости по категории
```
=AVERAGEIF(Блюда!C:C,"Категория",Блюда!E:E)
```

### Подсчет количества блюд в категории
```
=COUNTIF(Блюда!C:C,"Категория")
```

### Сортировка по любому критерию
```
=QUERY(Блюда!A:F,"SELECT B,E ORDER BY E DESC")
```

### Фильтрация по диапазону значений
```
=QUERY(Блюда!A:F,"SELECT B,E WHERE E > 100 AND E < 500")
```

## Советы по эффективному использованию

1. **Используйте абсолютные ссылки** для формул, которые нужно копировать
2. **Создавайте промежуточные листы** для сложных расчетов
3. **Применяйте условное форматирование** для визуализации данных
4. **Используйте фильтры** для быстрого поиска
5. **Создавайте сводные таблицы** для сложного анализа
6. **Регулярно обновляйте цены** и проверяйте актуальность данных
7. **Делайте резервные копии** важных данных
8. **Используйте комментарии** для объяснения сложных формул
